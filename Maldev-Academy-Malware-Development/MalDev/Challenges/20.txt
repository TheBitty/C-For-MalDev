 SystemFunction040 Encryption/Decryption
In this week's challenge, we will explore the use of SystemFunction040 and SystemFunction041 for encrypting sensitive data. These functions are similar to the previously discussed API, SystemFunction032 (used for RC4 encryption), but instead of performing data encryption in user mode using RC4, SystemFunction040 and SystemFunction041 handle data encryption and decryption in kernel mode, interacting with the Ksecdd.sys driver. SystemFunction040 and SystemFunction041 are available and documented, with SystemFunction040 being referred to as RtlEncryptMemory and SystemFunction041 as RtlDecryptMemory.

These functions can be employed to encrypt and decrypt various types of data, including shellcode, strings, and other potentially malicious data that we aim to conceal from security products.

Resources: 
- https://learn.microsoft.com/en-us/windows/win32/api/ntsecapi/nf-ntsecapi-rtlencryptmemory
- https://learn.microsoft.com/en-us/windows/win32/api/ntsecapi/nf-ntsecapi-rtldecryptmemory
